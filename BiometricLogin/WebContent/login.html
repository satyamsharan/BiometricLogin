<html>
<body>
<script>
function fnOpenDevice()
{
	
	document.forms[0].objFP.DeviceID = -1
	document.forms[0].objFP.CodeName = 3;
	document.forms[0].objFP.MinutiaeMode = 768;

// template format of objVerify should be the same to those of objFP[]
document.forms[0].objVerify.MinutiaeMode = 768;
document.forms[0].min1.value = "";
	return;
}


function fnCapture()
{
	var strmin;
	
	var flag = true;
	document.forms[0].objFP.Capture;
	var result = document.forms[0].objFP.ErrorCode;
	if (result == 0)
	{	
		//var strimg1 = objFP.ImageTextData;
	
		 strmin = document.forms[0].objFP.MinTextData;
		document.forms[0].min1.value = strmin;
	}
	 else if(result==52)
		{
			 alert('Please Init your device');
		}
		 else if(result==57)
			{
				 alert('Please put your finger on the device');
			}
	else
		
		{
		alert('failed - ' + result);
		
		}
	
	
	return flag;
}


</script>
<div id="biometricVerificationDiv" name="biometricVerificationDiv">
			<input type="button" value="Init Device" styleClass="buttonStyle" onclick="fnOpenDevice();" />
			<object id="objVerify" style="left: 0px; top: 0px" height="0" width="0" classid="CLSID:8D613732-7D38-4664-A8B7-A24049B96117"
        name="objVerify" viewastext codebase="sgfplibx.ocx#version=3,6,1,0">
    </object>
    
   			 <object id="objFP" style="left: 0px; width: 149px; top: 0px; height: 182px" height="182"
                            width="149" classid="CLSID:D547FDD7-82F6-44e8-AFBA-7553ADCEE7C8" name="objFP"
                            viewastext codebase="sgfplibx.ocx#version=3,6,1,0">
                          <param name="CodeName" value="1"></param>
              </object>
              <input type="button" value="Capture" property="capture" styleClass="buttonStyle" onclick="fnCapture();"/>
              <input type="hidden" id =" min1" name ="min1"/>
		</div>
		
	</body>
	</html>